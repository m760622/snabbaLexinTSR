import{A as c}from"./config-CfHoVMbv.js";import{D as a}from"./db-bEbbjtoI.js";class r{async checkCacheAndLoad(){try{console.log("[Loader] Initializing DB..."),await a.init();const e=localStorage.getItem("snabbaLexin_version"),t=localStorage.getItem("snabbaLexin_dataReady")==="true",n=await a.hasCachedData();if(n&&e===c.DATA_VERSION&&t){console.log("[Loader] Data ready - loading from cache...");const o=await a.getAllWords();window.dictionaryData=o,window.dispatchEvent(new Event("dictionaryLoaded"));return}else{console.log("[Loader] Data missing or outdated - Redirecting to Welcome..."),console.log("[Loader] Debug: hasCached=",n,"storedVersion=",e,"hasFlag=",t);const o=encodeURIComponent(window.location.pathname+window.location.search);window.location.replace(`welcome.html?redirect=${o}`)}}catch(e){console.warn("[Loader] Error checking cache:",e),window.location.replace("welcome.html")}}}const i=new r;document.querySelector('script[src*="loader.ts"]')&&i.checkCacheAndLoad();export{i as Loader};
