"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{const e=new URL("/assets/sw-BQj_SXJ1.ts",import.meta.url),t=await navigator.serviceWorker.register(e,{type:"module"});console.log("[PWA] ServiceWorker registered with URL:",e.href),t.addEventListener("updatefound",()=>{const n=t.installing;n&&(console.log("[PWA] New service worker installing..."),n.addEventListener("statechange",()=>{n.state==="installed"&&navigator.serviceWorker.controller&&i()}))})}catch(e){console.log("[PWA] ServiceWorker registration failed:",e)}});function i(){const e=document.getElementById("updatePrompt");if(e){e.classList.remove("hidden");const t=document.getElementById("updateBtn"),n=document.getElementById("dismissUpdate");t&&t.addEventListener("click",()=>{var s;(s=navigator.serviceWorker.controller)==null||s.postMessage({type:"SKIP_WAITING"}),window.location.reload()}),n&&n.addEventListener("click",()=>{e.classList.add("hidden")})}}window.addEventListener("online",()=>{const e=document.getElementById("offlineBanner");e&&e.classList.add("hidden")});window.addEventListener("offline",()=>{const e=document.getElementById("offlineBanner");e&&e.classList.remove("hidden")});if(!navigator.onLine){const e=document.getElementById("offlineBanner");e&&e.classList.remove("hidden")}let o=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),o=e;const t=document.getElementById("installApp"),n=document.getElementById("pwa-install-prompt");t&&(t.classList.remove("hidden"),t.addEventListener("click",async()=>{if(o){o.prompt();const{outcome:s}=await o.userChoice;console.log("[PWA] User response:",s),o=null,t.classList.add("hidden")}})),n&&!localStorage.getItem("pwa-prompt-dismissed")&&setTimeout(()=>{n.classList.remove("hidden")},5e3)});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("pwa-install-btn"),t=document.getElementById("pwa-later-btn"),n=document.getElementById("pwa-install-prompt");e&&e.addEventListener("click",async()=>{if(o){o.prompt();const{outcome:s}=await o.userChoice;console.log("[PWA] Install prompt outcome:",s),o=null}n&&n.classList.add("hidden")}),t&&t.addEventListener("click",()=>{n&&n.classList.add("hidden"),localStorage.setItem("pwa-prompt-dismissed","true")})});const a=/iPad|iPhone|iPod/.test(navigator.userAgent),d=window.matchMedia("(display-mode: standalone)").matches||navigator.standalone;if(a&&!d){const e=document.getElementById("iosInstallPrompt");if(e&&!localStorage.getItem("ios-prompt-dismissed")){setTimeout(()=>{e.classList.remove("hidden"),setTimeout(()=>{e.style.transition="opacity 0.5s ease-out, transform 0.5s ease-out",e.style.opacity="0",e.style.transform="translateY(20px)",setTimeout(()=>{e.classList.add("hidden"),e.style.opacity="",e.style.transform="",e.style.transition=""},500)},15e3)},1e4);const t=document.getElementById("closeIosPrompt");t&&t.addEventListener("click",()=>{e.classList.add("hidden"),localStorage.setItem("ios-prompt-dismissed","true")})}}console.log("[PWA] Module loaded");
