var R=Object.defineProperty;var X=(t,e,n)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var E=(t,e,n)=>X(t,typeof e!="symbol"?e+"":e,n);import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */import"./loader-CqI2jdYk.js";import{A as p}from"./config-CfHoVMbv.js";import"./pwa-Bn3RWWLO.js";import"./db-bEbbjtoI.js";const v=p.COLUMNS.SWEDISH,A=p.COLUMNS.ARABIC,D=p.COLUMNS.TYPE,U=p.COLUMNS.EXAMPLE_SWE,Y=p.COLUMNS.EXAMPLE_ARB;let B=[],c=[],x=0,g=0,m=0,d=null,u=0,h=!1,T="all",f=0,w=0,C="easy",O=[];const k=localStorage.getItem("theme")||"dark";document.documentElement.setAttribute("data-theme",k);k==="dark"&&document.body.classList.add("dark-mode");function F(){return new Promise(t=>{const e=()=>{typeof dictionaryData<"u"&&Array.isArray(dictionaryData)&&dictionaryData.length>0?t(dictionaryData):setTimeout(e,100)};e()})}async function P(){try{O=await F();const e=()=>{r.init(),r.resume(),document.removeEventListener("click",e),document.removeEventListener("touchstart",e)};document.addEventListener("click",e),document.addEventListener("touchstart",e),L()}catch(t){console.error("Error initializing memory game:",t)}}function L(){H(),J(),et()}function H(){B=[],c=[],x=0,g=0,m=0,m=0,h=!1,u=0,f=0,w=0,d&&(clearInterval(d),d=null),S()}function q(){let t=O.filter(n=>n[v]&&n[A]);T!=="all"&&(t=t.filter(n=>(n[D]||"").toLowerCase().includes(T)));const e=C==="hard"?12:6;return _(t).slice(0,e)}function _(t){const e=[...t];for(let n=e.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[e[n],e[i]]=[e[i],e[n]]}return e}function J(){const t=document.getElementById("memoryGrid");if(!t)return;t.innerHTML="",t.style.gridTemplateColumns="repeat(4, 1fr)";const e=q(),n=[];e.forEach((o,a)=>{n.push({text:o[v],pairId:a,isArabic:!1,wordData:o}),n.push({text:o[A],pairId:a,isArabic:!0,wordData:o})}),_(n).forEach((o,a)=>{const s=document.createElement("div");s.className="card",s.dataset.pairId=String(o.pairId),s.dataset.index=String(a),s.style.animationDelay=`${a*.05}s`,s.style.animation="cardEntrance 0.5s ease-out forwards",s.addEventListener("animationend",()=>{s.style.animation=""});const l=o.isArabic&&o.text.length<7;s.innerHTML=`
            <div class="face front"></div>
            <div class="face back ${o.isArabic?"arabic":""} ${l?"is-short":""}">
                <div class="card-content">${o.text}</div>
            </div>
        `,s.addEventListener("click",()=>z(s,o)),s.addEventListener("mousemove",b=>{if(s.classList.contains("flipped")||s.classList.contains("matched"))return;const y=s.getBoundingClientRect(),N=b.clientX-y.left,W=b.clientY-y.top,I=y.width/2,M=y.height/2,V=(W-M)/M*-10,$=(N-I)/I*10;s.style.transform=`perspective(1000px) rotateX(${V}deg) rotateY(${$}deg) scale(1.05)`}),s.addEventListener("mouseleave",()=>{!s.classList.contains("flipped")&&!s.classList.contains("matched")&&(s.style.transform="")}),t.appendChild(s),B.push(s)})}function j(t,e){if(typeof window.confetti=="function"){const n=t/window.innerWidth,i=e/window.innerHeight;window.confetti({particleCount:30,spread:40,startVelocity:20,origin:{x:n,y:i},colors:["#34d399","#22d3ee","#fbbf24"]})}}function z(t,e){if(!(h||t.classList.contains("flipped")||t.classList.contains("matched"))&&(t.style.transform="",t.classList.add("flipped"),c.push(t),r.playFlip(),c.length===2)){h=!0,g++,S();const[n,i]=c,o=n.dataset.pairId,a=i.dataset.pairId;o===a?K(e.wordData):Q()}}function K(t){const e=Date.now();e-w<5e3?f++:f=1,w=e,setTimeout(()=>{c.forEach(a=>{a.classList.add("matched");const s=a.getBoundingClientRect();j(s.left+s.width/2,s.top+s.height/2)}),x++;const n=100+Math.max(0,50-g*2),i=(f-1)*50;m+=n+i,Z(t,f),r.playMatch(),r.speak(t[v]),c=[],h=!1,S(),x===(C==="hard"?12:6)&&tt()},500)}function Q(){setTimeout(()=>{c.forEach(t=>{t.classList.add("shake"),setTimeout(()=>{t.classList.remove("shake","flipped")},500)}),r.playWrong(),c=[],h=!1},1e3)}function Z(t,e=0){const n=document.getElementById("feedbackToast"),i=document.getElementById("ftWord"),o=document.getElementById("ftSentenceSwe"),a=document.getElementById("ftSentenceArb");if(n&&i&&o&&a){let s=t[v];e>1&&(s+=` (COMBO x${e}!)`),i.textContent=s,o.textContent=t[U]||"",a.textContent=t[Y]||"",n.classList.add("visible"),setTimeout(()=>{n.classList.remove("visible")},2500)}}function tt(){d&&(clearInterval(d),d=null);const t=document.getElementById("gameOverModal"),e=document.getElementById("finalScore"),n=document.getElementById("finalMoves"),i=document.getElementById("finalTime");t&&e&&n&&i&&(e.textContent=String(m),n.textContent=String(g),i.textContent=G(u),t.classList.add("visible"),st(),r.playWin()),it()}function et(){d=setInterval(()=>{u++,S()},1e3)}function G(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}function S(){const t=document.getElementById("scoreValue"),e=document.getElementById("movesValue"),n=document.getElementById("timerValue");t&&(t.textContent=String(m)),e&&(e.textContent=String(g)),n&&(n.textContent=G(u))}class nt{constructor(){E(this,"ctx",null);E(this,"enabled",!0);E(this,"synthesis");this.synthesis=window.speechSynthesis,this.enabled=localStorage.getItem("memory_sound_enabled")!=="false"}init(){this.ctx||(this.ctx=new(window.AudioContext||window.webkitAudioContext)),this.ctx.state==="suspended"&&this.ctx.resume(),this.updateMuteIcon()}resume(){this.ctx&&this.ctx.state==="suspended"&&this.ctx.resume()}toggle(){this.enabled=!this.enabled,localStorage.setItem("memory_sound_enabled",String(this.enabled)),this.updateMuteIcon()}updateMuteIcon(){const e=document.getElementById("soundToggleBtn");e&&(e.innerHTML=this.enabled?"ðŸ”Š":"ðŸ”‡",e.classList.toggle("muted",!this.enabled))}playFlip(){!this.enabled||!this.ctx||(this.playTone(400,"sine",.1,0,.05),this.playTone(600,"triangle",.05,.05,.02))}playMatch(){!this.enabled||!this.ctx||(this.playTone(523.25,"sine",.4,0,.1),this.playTone(659.25,"sine",.4,.1,.1),this.playTone(783.99,"sine",.6,.2,.1),this.playTone(1046.5,"sine",.8,.3,.05))}playWrong(){!this.enabled||!this.ctx||(this.playTone(300,"sawtooth",.3,0,.05),this.playTone(280,"sawtooth",.3,.1,.05))}playWin(){if(!this.enabled||!this.ctx)return;[523.25,659.25,783.99,1046.5,1318.51,1567.98].forEach((n,i)=>{this.playTone(n,"sine",.6,i*.15,.1)})}playTone(e,n,i,o,a){if(!this.ctx)return;const s=this.ctx.createOscillator(),l=this.ctx.createGain();s.type=n,s.frequency.setValueAtTime(e,this.ctx.currentTime+o),l.gain.setValueAtTime(0,this.ctx.currentTime+o),l.gain.linearRampToValueAtTime(a,this.ctx.currentTime+o+.02),l.gain.exponentialRampToValueAtTime(.001,this.ctx.currentTime+o+i),s.connect(l),l.connect(this.ctx.destination),s.start(this.ctx.currentTime+o),s.stop(this.ctx.currentTime+o+i+.1)}speak(e,n="sv-SE"){if(!this.enabled)return;this.synthesis.cancel();const i=new SpeechSynthesisUtterance(e);i.lang=n,i.rate=.9,i.pitch=1;const a=this.synthesis.getVoices().find(s=>s.lang.includes(n));a&&(i.voice=a),this.synthesis.speak(i)}}const r=new nt;window.toggleSound=()=>r.toggle();function st(){typeof window.confetti=="function"&&window.confetti({particleCount:150,spread:70,origin:{y:.6}})}function it(){try{const t=JSON.parse(localStorage.getItem("memoryGameStats")||"{}");t.gamesPlayed=(t.gamesPlayed||0)+1,t.bestScore=Math.max(t.bestScore||0,m),t.bestTime=t.bestTime?Math.min(t.bestTime,u):u,localStorage.setItem("memoryGameStats",JSON.stringify(t))}catch(t){console.error("Error saving stats:",t)}}function ot(t,e){T=t,document.querySelectorAll("#categorySelector .pill").forEach(n=>n.classList.remove("active")),e.classList.add("active"),L()}function at(t,e){C=t,document.querySelectorAll("#difficultySelector .pill").forEach(n=>n.classList.remove("active")),e.classList.add("active"),L()}function ct(){const t=document.getElementById("gameOverModal");t&&t.classList.remove("visible"),L()}window.selectCategory=ot;window.setDifficulty=at;window.restartGame=ct;document.addEventListener("DOMContentLoaded",P);window.addEventListener("dictionaryLoaded",P);
