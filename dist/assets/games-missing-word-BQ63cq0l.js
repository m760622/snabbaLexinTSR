import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{s as m,C as u,b as c,c as E,a as w,t as M}from"./games-utils-ODhg8alW.js";import"./loader-BlPi5qr6.js";import"./config-8gd_ljfe.js";import"./i18n-Dq4jSOyT.js";import"./toast-manager-DdtDDR9Z.js";import"./db-CUAitF01.js";console.log("missingWordGame.ts LOADED");let g=0;function L(n=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){n<10?(console.warn(`Data not ready for Missing Word. Retrying (${n+1}/10)...`),typeof m=="function"&&m("Laddar speldata... / جاري تحميل البيانات...","info"),setTimeout(()=>L(n+1),500)):(console.error("Critical: Data failed to load for Missing Word."),typeof m=="function"&&m("Kunde inte ladda data. Uppdatera sidan. / تعذر تحميل البيانات.","error"));return}g=0;const e=document.getElementById("gameScore");e&&(e.textContent="0"),p()}function p(){const n=document.getElementById("gameSentence"),e=document.getElementById("gameHint"),o=document.getElementById("gameOptions"),a=document.getElementById("gameFeedback"),d=document.getElementById("nextQuestionBtn");a&&(a.innerHTML=""),d&&(d.style.display="none",d.classList.add("hidden")),o&&(o.innerHTML='<div class="skeleton-loader">Laddar...</div>');let s=null,i=0;if(typeof dictionaryData>"u"){console.error("dictionaryData is undefined");return}for(;!s&&i<200;){const t=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];if(t&&t[u]&&t[c]&&t[E]){const r=t[u],h=t[c];r.toLowerCase().includes(h.toLowerCase())&&h.length>2&&(s=t)}i++}if(!s){n&&(n.textContent="Kunde inte hitta en fråga. Försök igen."),e&&(e.textContent=""),o&&(o.innerHTML='<button class="game-option" onclick="loadMissingWordQuestion()">Försök igen</button>');return}const f=s[c],k=s[u],B=s[E],C=new RegExp(f,"i"),S=k.replace(C,"______");n&&(n.innerHTML=S),e&&(e.textContent=B);const l=[f];let y=0;for(;l.length<4&&y<100;){const t=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];t&&t[c]&&t[c]!==f&&!l.includes(t[c])&&t[c].length>2&&l.push(t[c]),y++}l.sort(()=>Math.random()-.5),o&&(o.innerHTML="",l.forEach(t=>{const r=document.createElement("button");r.className="game-option",r.textContent=t,r.onclick=()=>x(t,f,r),o.appendChild(r)}))}function x(n,e,o){const a=document.getElementById("gameFeedback"),d=document.getElementById("nextQuestionBtn"),s=document.querySelectorAll(".game-option");if(s.forEach(i=>i.disabled=!0),n===e){o.classList.add("correct"),a&&(a.textContent="✅ Rätt! / صحيح!",a.className="game-feedback success"),g++;const i=document.getElementById("gameScore");i&&(i.textContent=String(g)),typeof w=="function"&&w("missing-word",g),typeof playSuccessSound=="function"&&playSuccessSound(),typeof M=="function"&&M()}else o.classList.add("wrong"),a&&(a.textContent=`❌ Fel! Rätt svar: ${e}`,a.className="game-feedback error"),s.forEach(i=>{i.textContent===e&&i.classList.add("correct")}),typeof playErrorSound=="function"&&playErrorSound();d&&(d.classList.remove("hidden"),d.style.display="block",d.onclick=p)}window.startMissingWordGame=L;window.loadMissingWordQuestion=p;window.checkMissingWordAnswer=x;
