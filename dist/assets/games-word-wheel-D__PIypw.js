import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import"./loader-aeyOlNIl.js";import"./games-utils-BqIcxbKk.js";import{L as S,t as i}from"./i18n-BpwFYk4h.js";import"./config-BpQc0ceR.js";import"./db-C5HhRm-y.js";import"./toast-manager-DdtDDR9Z.js";console.log("wordWheelGame.ts LOADED");document.addEventListener("DOMContentLoaded",()=>{T(),S&&S.onLanguageChange(()=>{T()})});function T(){const e=document.getElementById("wordWheelLength");if(e){const n=i("games.letters");for(let t=0;t<e.options.length;t++){const o=e.options[t],a=o.value;o.text=`${a} ${n}`}}}let s=null,l="",u=0,v=3;function g(e=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){console.log("Data not ready for Word Wheel. Waiting for dictionaryLoaded event...");const r=()=>{console.log("dictionaryLoaded event received in Word Wheel Game"),window.removeEventListener("dictionaryLoaded",r),g(0)};window.addEventListener("dictionaryLoaded",r),e<20?setTimeout(()=>{(typeof dictionaryData>"u"||dictionaryData.length===0)&&g(e+1)},500):(console.error("Critical: Data failed to load for Word Wheel."),typeof showToast=="function"&&showToast(i("common.error"),"error"));return}const n=document.getElementById("wheelAnswerBox"),t=document.getElementById("wheelHint"),o=document.getElementById("wheelLetters"),a=document.getElementById("wheelFeedback"),d=document.getElementById("wheelExample"),h=document.getElementById("nextWheelBtn2"),L=document.getElementById("wordWheelLength");if(!n||!t||!o||!a||!d||!h)return;v=L?parseInt(L.value):3,a.innerHTML="",a.className="game-feedback",d.classList.add("hidden"),h.classList.add("hidden"),n.innerHTML="",l="";let m=null,E=0;for(;!m&&E<500;){const r=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];if(r&&r[COL_SWE]&&r[COL_ARB]){const f=r[COL_SWE].toUpperCase();f.length===v&&!f.includes(" ")&&!f.includes("-")&&/^[A-ZÃ…Ã„Ã–]+$/.test(f)&&(m={word:f,translation:r[COL_ARB],example:r[COL_EX]||"",exampleArb:r[COL_EX_ARB]||""})}E++}if(!m){t.textContent=i("details.noWordFound"),o.innerHTML='<button class="wheel-letter" onclick="startWordWheelGame()">ðŸ”„</button>';return}s=m,t.textContent=m.translation;const B=m.translation.length;B>15?t.style.fontSize="1.5rem":B>10?t.style.fontSize="1.8rem":t.style.fontSize="2.2rem";const w=m.word.length;let W=44;const I=6.4;w>6?(n.classList.add("small-text"),W=36):n.classList.remove("small-text");const A=w*W+(w-1)*I+30;n.style.width=`${A}px`,n.style.minWidth="0";const x=m.word.split("").sort(()=>Math.random()-.5);o.innerHTML="",x.forEach((r,f)=>{const c=document.createElement("button");c.className="wheel-letter",c.textContent=r,c.dataset.index=String(f),c.onclick=()=>D(c,r);const b=f/x.length*2*Math.PI-Math.PI/2,k=45,H=50+k*Math.cos(b),$=50+k*Math.sin(b);c.style.left=`${H}%`,c.style.top=`${$}%`,c.style.transform="translate(-50%, -50%)",o.appendChild(c)});const M=document.getElementById("wheelCheckBtn");M&&(M.onclick=C),y()}function y(){const e=document.getElementById("wheelShowAnswerBtn");e&&(u>=1?(e.disabled=!1,e.title=`${i("games.showAnswer")} (${i("games.costPoint")})`):(e.disabled=!0,e.title=i("games.needPoints").replace("{0}","1")))}function D(e,n){e.classList.contains("used")||(typeof soundManager<"u"&&(soundManager!=null&&soundManager.playClick)&&soundManager.playClick(),e.classList.add("used"),l+=n,p(),s&&l.length===s.word.length&&C())}function p(){const e=document.getElementById("wheelAnswerBox"),n=document.getElementById("wheelFeedback");e&&(e.innerHTML="",e.classList.remove("shake-error"),n&&(n.innerHTML=""),l.split("").forEach((t,o)=>{const a=document.createElement("span");a.className="wheel-answer-letter",a.textContent=t,a.onclick=()=>O(o,t),e.appendChild(a)}))}function O(e,n){typeof soundManager<"u"&&(soundManager!=null&&soundManager.playClick)&&soundManager.playClick(),l=l.slice(0,e)+l.slice(e+1);const t=document.getElementById("wheelLetters");if(t){const o=t.querySelectorAll(".wheel-letter.used");let a=!1;o.forEach(d=>{!a&&d.textContent===n&&(d.classList.remove("used"),a=!0)})}p()}function C(){const e=document.getElementById("wheelFeedback"),n=document.getElementById("wheelExample"),t=document.getElementById("nextWheelBtn2"),o=document.getElementById("wheelAnswerBox"),a=document.getElementById("wordWheelScore");if(!(!e||!n||!t||!o||!s))if(l.toUpperCase()===s.word){if(typeof soundManager<"u"&&(soundManager!=null&&soundManager.playSuccess)&&soundManager.playSuccess(),e.innerHTML=`âœ… ${i("games.feedbackSuccess")}`,e.className="game-feedback success",u++,a&&(a.textContent=String(u)),y(),s.example){let d=`ðŸ’¡ ${s.example}`;s.exampleArb&&(d+=`<br><span class="arb-example" style="color: #fbbf24; font-weight: bold; display: block; margin-top: 0.5rem;">${s.exampleArb}</span>`),n.innerHTML=d,n.classList.remove("hidden")}typeof saveScore=="function"&&saveScore("word-wheel",u),typeof TTSManager<"u"&&TTSManager&&TTSManager.speak(s.word.toLowerCase(),"sv"),t.classList.remove("hidden")}else typeof soundManager<"u"&&(soundManager!=null&&soundManager.playError)&&soundManager.playError(),o.classList.add("shake-error"),setTimeout(()=>o.classList.remove("shake-error"),500),e.innerHTML=`âŒ ${i("games.feedbackError")}`,e.className="game-feedback error",navigator.vibrate&&navigator.vibrate(200)}function _(){if(l.length>0){const e=l[l.length-1];l=l.slice(0,-1);const n=document.getElementById("wheelLetters");if(n){const t=Array.from(n.querySelectorAll(".wheel-letter.used"));for(let o=t.length-1;o>=0;o--)if(t[o].textContent===e){t[o].classList.remove("used");break}}p()}}function N(){g()}function F(){if(!s)return;if(u<1){typeof showToast=="function"&&showToast(i("games.needPoints").replace("{0}","1"),"error");return}u--;const e=document.getElementById("wordWheelScore");e&&(e.textContent=String(u)),y(),l=s.word;const n=document.getElementById("wheelLetters");n&&n.querySelectorAll(".wheel-letter").forEach(h=>h.classList.add("used")),p();const t=document.getElementById("wheelFeedback"),o=document.getElementById("wheelExample"),a=document.getElementById("nextWheelBtn2");if(!(!t||!o||!a)){if(typeof soundManager<"u"&&(soundManager!=null&&soundManager.playSuccess)&&soundManager.playSuccess(),t.innerHTML=`âœ… ${i("games.solved")}`,t.className="game-feedback success",s.example){let d=`ðŸ’¡ ${s.example}`;s.exampleArb&&(d+=`<br><span class="arb-example" style="color: #fbbf24; font-weight: bold; display: block; margin-top: 0.5rem;">${s.exampleArb}</span>`),o.innerHTML=d,o.classList.remove("hidden")}typeof TTSManager<"u"&&TTSManager&&TTSManager.speak(s.word.toLowerCase(),"sv"),a.classList.remove("hidden")}}window.startWordWheelGame=g;window.undoWordWheel=_;window.skipWordWheel=N;window.showWordWheelAnswer=F;
