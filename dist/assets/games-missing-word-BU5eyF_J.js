import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{s as m,C as u,b as d,c as E,a as M,t as L}from"./games-utils-BqIcxbKk.js";import"./loader-aeyOlNIl.js";import"./config-BpQc0ceR.js";import"./i18n-BpwFYk4h.js";import"./toast-manager-DdtDDR9Z.js";import"./db-C5HhRm-y.js";console.log("missingWordGame.ts LOADED");let g=0;function w(n=0){if(typeof dictionaryData>"u"||dictionaryData.length===0){n<10?(console.warn(`Data not ready for Missing Word. Retrying (${n+1}/10)...`),typeof m=="function"&&m("Laddar speldata... / جاري تحميل البيانات...","info"),setTimeout(()=>w(n+1),500)):(console.error("Critical: Data failed to load for Missing Word."),typeof m=="function"&&m("Kunde inte ladda data. Uppdatera sidan. / تعذر تحميل البيانات.","error"));return}g=0;const e=document.getElementById("gameScore");e&&(e.textContent="0"),p()}function p(){const n=document.getElementById("gameSentence"),e=document.getElementById("gameHint"),o=document.getElementById("gameOptions"),a=document.getElementById("gameFeedback"),r=document.getElementById("nextQuestionBtn");a&&(a.innerHTML=""),r&&(r.style.display="none",r.classList.add("hidden")),o&&(o.innerHTML='<div class="skeleton-loader">Laddar...</div>');let s=null,i=0;if(typeof dictionaryData>"u"){console.error("dictionaryData is undefined");return}for(;!s&&i<200;){const t=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];if(t&&t[u]&&t[d]&&t[E]){const c=t[u],h=t[d];c.toLowerCase().includes(h.toLowerCase())&&h.length>2&&(s=t)}i++}if(!s){n&&(n.textContent="Kunde inte hitta en fråga. Försök igen."),e&&(e.textContent=""),o&&(o.innerHTML='<button class="game-option" onclick="loadMissingWordQuestion()">Försök igen</button>');return}const f=s[d],B=s[u],x=s[E],C=new RegExp(f,"i"),S=B.replace(C,"______");n&&(n.innerHTML=S),e&&(e.textContent=x);const l=[f];let y=0;for(;l.length<4&&y<100;){const t=dictionaryData[Math.floor(Math.random()*dictionaryData.length)];t&&t[d]&&t[d]!==f&&!l.includes(t[d])&&t[d].length>2&&l.push(t[d]),y++}l.sort(()=>Math.random()-.5),o&&(o.innerHTML="",l.forEach(t=>{const c=document.createElement("button");c.className="game-option",c.textContent=t,c.onclick=()=>k(t,f,c),o.appendChild(c)}))}function k(n,e,o){const a=document.getElementById("gameFeedback"),r=document.getElementById("nextQuestionBtn"),s=document.querySelectorAll(".game-option");if(s.forEach(i=>i.disabled=!0),n===e){o.classList.add("correct"),a&&(a.innerHTML="✅ Rätt! / صحيح!",a.className="game-feedback success"),g++;const i=document.getElementById("gameScore");i&&(i.textContent=String(g)),typeof M=="function"&&M("missing-word",g),typeof playSuccessSound=="function"&&playSuccessSound(),typeof L=="function"&&L()}else o.classList.add("wrong"),a&&(a.innerHTML=`❌ Fel! Rätt svar: <strong>${e}</strong>`,a.className="game-feedback error"),s.forEach(i=>{i.textContent===e&&i.classList.add("correct")}),typeof playErrorSound=="function"&&playErrorSound();r&&(r.classList.remove("hidden"),r.style.display="block",r.onclick=p)}window.startMissingWordGame=w;window.loadMissingWordQuestion=p;window.checkMissingWordAnswer=k;
