import"./modulepreload-polyfill-B5Qt9EMX.js";import{j as e,r as j,c as P,R as M}from"./client-Chk-tuEE.js";import"./pwa-Bn3RWWLO.js";const E=({progress:s,size:a=120,strokeWidth:r=8,color:c="var(--aurora-1, #2dd4bf)",bgColor:l="rgba(255, 255, 255, 0.1)",children:v})=>{const o=(a-r)/2,x=o*2*Math.PI,m=x-s/100*x;return e.jsxs("div",{className:"circular-progress",style:{width:a,height:a},children:[e.jsxs("svg",{width:a,height:a,children:[e.jsx("circle",{className:"circular-progress-bg",stroke:l,strokeWidth:r,fill:"transparent",r:o,cx:a/2,cy:a/2}),e.jsx("circle",{className:"circular-progress-bar",stroke:c,strokeWidth:r,strokeLinecap:"round",fill:"transparent",r:o,cx:a/2,cy:a/2,style:{strokeDasharray:x,strokeDashoffset:m,transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dashoffset 0.5s ease-out"}})]}),e.jsx("div",{className:"circular-progress-content",children:v})]})},A=({days:s,isActive:a=!0})=>{const c=s===0?"inactive":s<3?"low":s<7?"medium":s<30?"high":"legendary";return e.jsxs("div",{className:`streak-counter streak-${c} ${a?"active":""}`,children:[e.jsxs("div",{className:"streak-fire",children:[e.jsx("span",{className:"fire-emoji",children:"ðŸ”¥"}),s>=7&&e.jsx("span",{className:"fire-extra",children:"âœ¨"})]}),e.jsxs("div",{className:"streak-info",children:[e.jsx("span",{className:"streak-value",children:s}),e.jsxs("span",{className:"streak-label",children:[e.jsx("span",{className:"sv-text",children:"dagar"}),e.jsx("span",{className:"ar-text",children:"Ø£ÙŠØ§Ù…"})]})]})]})},C=({current:s,target:a,label:r})=>{const c=Math.min(s/a*100,100),l=s>=a;return e.jsxs("div",{className:`daily-goal-bar ${l?"complete":""}`,children:[e.jsxs("div",{className:"goal-header",children:[e.jsx("span",{className:"goal-label",children:r||e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"sv-text",children:"Dagens mÃ¥l"}),e.jsx("span",{className:"ar-text",children:"Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…"})]})}),e.jsxs("span",{className:"goal-progress",children:[s,"/",a,l&&e.jsx("span",{className:"goal-check",children:" âœ“"})]})]}),e.jsx("div",{className:"goal-track",children:e.jsx("div",{className:"goal-fill",style:{width:`${c}%`}})})]})};function O(){const[s,a]=j.useState(!0),[r,c]=j.useState(null),[l,v]=j.useState({xp:0,level:1,xpToNextLevel:100,xpProgress:0,streak:0,isStreakActive:!1,masteredWords:0,totalWords:0,dailyProgress:0,dailyGoal:10,weeklyActivity:[0,0,0,0,0,0,0]}),o=t=>{const i=Math.floor(Math.sqrt(t/100))+1,h=(i-1)**2*100,d=i**2*100,p=t-h,g=d-h,n=p/g*100;return{level:i,xpToNext:d-t,progress:Math.min(n,100)}},x=t=>{if(!t)return!1;const i=new Date(t);return Math.floor((new Date().getTime()-i.getTime())/(1e3*60*60*24))<=1},m=async()=>{a(!0),c(null);try{const i=JSON.parse(localStorage.getItem("userSettings")||"{}").dailyGoal||10,h=parseInt(localStorage.getItem("userXP")||"0",10),{level:d,xpToNext:p,progress:g}=o(h),n=JSON.parse(localStorage.getItem("streakData")||'{"count": 0, "lastDate": null}'),N=x(n.lastDate),y=JSON.parse(localStorage.getItem("wordAssessments")||"{}"),b=Object.values(y).filter(u=>u.level>=4).length,w=Object.keys(y).length,D=new Date().toISOString().split("T")[0],I=parseInt(localStorage.getItem(`daily_${D}`)||"0",10),k=[];for(let u=6;u>=0;u--){const f=new Date;f.setDate(f.getDate()-u);const L=f.toISOString().split("T")[0];k.push(parseInt(localStorage.getItem(`daily_${L}`)||"0",10))}v({xp:h,level:d,xpToNextLevel:p,xpProgress:g,streak:n.count||0,isStreakActive:N,masteredWords:b,totalWords:w,dailyProgress:I,dailyGoal:i,weeklyActivity:k})}catch(t){console.error("[useProfileData] Error:",t),c("Failed to load profile data")}finally{a(!1)}};return j.useEffect(()=>{m();const t=()=>m();return window.addEventListener("storage",t),window.addEventListener("xpUpdated",t),()=>{window.removeEventListener("storage",t),window.removeEventListener("xpUpdated",t)}},[]),{...l,isLoading:s,error:r,refresh:m}}const T=[{id:"b1",name:"Ø§Ù„Ù…Ø¨ØªØ¯Ø¦ Ø§Ù„ÙˆØ§Ø¹Ø¯",icon:"ðŸŒ±",description:"Ø£ØªÙ‚Ù† 5 ÙƒÙ„Ù…Ø§Øª",requirement:s=>s.wordsMastered>=5},{id:"b2",name:"Ø´Ø¹Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø·",icon:"ðŸ”¥",description:"Ø³Ù„Ø³Ù„Ø© 3 Ø£ÙŠØ§Ù…",requirement:s=>s.currentStreak>=3},{id:"b3",name:"Ù‚Ø§Ù…ÙˆØ³ Ø¨Ø´Ø±ÙŠ",icon:"ðŸ“š",description:"Ø£ØªÙ‚Ù† 50 ÙƒÙ„Ù…Ø©",requirement:s=>s.wordsMastered>=50},{id:"b4",name:"Ø¨Ø·Ù„ Ø§Ù„Ù†Ø·Ù‚",icon:"ðŸŽ¤",description:"Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø®ØªØ¨Ø± Ø§Ù„Ù†Ø·Ù‚",requirement:s=>s.speechCount>=10}],F=({stats:s})=>e.jsxs("div",{className:"badges-section",children:[e.jsx("h3",{className:"badges-title",children:"Ø£ÙˆØ³Ù…Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² ðŸ†"}),e.jsx("div",{className:"badges-grid",children:T.map(a=>{const r=a.requirement(s);return e.jsxs("div",{className:`badge-card ${r?"unlocked":"locked"}`,children:[e.jsx("div",{className:"badge-icon-wrapper",children:e.jsx("span",{className:"badge-icon",children:a.icon})}),e.jsx("div",{className:"badge-name",children:a.name}),e.jsx("div",{className:"badge-desc",children:a.description}),!r&&e.jsx("div",{className:"badge-locked-hint",children:"ðŸ”’ Ù‚ÙŠØ¯ Ø§Ù„Ù‚ÙÙ„"})]},a.id)})})]}),R=()=>{const{xp:s,level:a,xpProgress:r,xpToNextLevel:c,streak:l,isStreakActive:v,masteredWords:o,dailyProgress:x,dailyGoal:m,weeklyActivity:t,isLoading:i}=O();if(i)return e.jsx("div",{className:"profile-loading",children:e.jsx("div",{className:"loading-spinner"})});const d=(n=>n<=2?{sv:"NybÃ¶rjare",ar:"Ù…Ø¨ØªØ¯Ø¦"}:n<=5?{sv:"Elev",ar:"Ø·Ø§Ù„Ø¨"}:n<=10?{sv:"Avancerad",ar:"Ù…ØªÙ‚Ø¯Ù…"}:n<=20?{sv:"Expert",ar:"Ø®Ø¨ÙŠØ±"}:{sv:"MÃ¤stare",ar:"Ù…Ø§Ù‡Ø±"})(a),p={sv:["MÃ¥n","Tis","Ons","Tor","Fre","LÃ¶r","SÃ¶n"],ar:["Ø§Ø«Ù†","Ø«Ù„Ø§","Ø£Ø±Ø¨","Ø®Ù…ÙŠ","Ø¬Ù…Ø¹","Ø³Ø¨Øª","Ø£Ø­Ø¯"]},g=Math.max(...t,1);return e.jsxs("div",{className:"profile-dashboard",children:[e.jsxs("div",{className:"profile-hero-react",children:[e.jsx(E,{progress:r,size:140,strokeWidth:10,color:"var(--aurora-1, #2dd4bf)",children:e.jsxs("div",{className:"xp-center",children:[e.jsx("span",{className:"xp-level",children:a}),e.jsxs("span",{className:"xp-label",children:[e.jsx("span",{className:"sv-text",children:"NivÃ¥"}),e.jsx("span",{className:"ar-text",children:"Ù…Ø³ØªÙˆÙ‰"})]})]})}),e.jsxs("div",{className:"profile-info",children:[e.jsxs("h2",{className:"profile-name",children:[e.jsx("span",{className:"sv-text",children:"InlÃ¤rare"}),e.jsx("span",{className:"ar-text",children:"Ø§Ù„Ù…ØªØ¹Ù„Ù…"})]}),e.jsxs("div",{className:"level-badge",children:["ðŸŒŸ ",e.jsx("span",{className:"sv-text",children:d.sv}),e.jsx("span",{className:"ar-text",children:d.ar})]}),e.jsxs("div",{className:"xp-info",children:[e.jsxs("span",{className:"xp-current",children:[s," XP"]}),e.jsxs("span",{className:"xp-next",children:["â€¢ ",c," till nÃ¤sta"]})]})]})]}),e.jsxs("div",{className:"stats-grid-react",children:[e.jsx(A,{days:l,isActive:v}),e.jsxs("div",{className:"stat-card-react",children:[e.jsx("div",{className:"stat-value",children:o}),e.jsxs("div",{className:"stat-label",children:["ðŸ“– ",e.jsx("span",{className:"sv-text",children:"Ord"}),e.jsx("span",{className:"ar-text",children:"ÙƒÙ„Ù…Ø§Øª"})]})]}),e.jsxs("div",{className:"stat-card-react",children:[e.jsx("div",{className:"stat-value",children:s}),e.jsx("div",{className:"stat-label",children:"â­ XP"})]})]}),e.jsx("div",{className:"section-card-react",children:e.jsx(C,{current:x,target:m})}),e.jsxs("div",{className:"section-card-react",children:[e.jsxs("h3",{className:"section-title-react",children:["ðŸ“ˆ ",e.jsx("span",{className:"sv-text",children:"Veckoaktivitet"}),e.jsx("span",{className:"ar-text",children:"Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"})]}),e.jsx("div",{className:"weekly-chart-react",children:t.map((n,N)=>e.jsxs("div",{className:"chart-bar-container",children:[e.jsx("div",{className:"chart-bar",style:{height:`${n/g*100}%`}}),e.jsxs("span",{className:"chart-label",children:[e.jsx("span",{className:"sv-text",children:p.sv[N]}),e.jsx("span",{className:"ar-text",children:p.ar[N]})]})]},N))})]}),e.jsx(F,{stats:{wordsMastered:o,currentStreak:l,speechCount:parseInt(localStorage.getItem("ttsUsage")||"0",10)}})]})};function S(){const s=document.getElementById("profile-root");if(!s){console.error("[ProfileReact] Mount point #profile-root not found");return}P.createRoot(s).render(e.jsx(M.StrictMode,{children:e.jsx(R,{})})),console.log("[ProfileReact] Mounted successfully")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();console.log("[ProfileApp] React profile loaded");
