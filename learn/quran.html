<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnabbaLexin - <span class="sv-text">KoraninlÃ¤rning</span><span class="ar-text">ØªØ¹Ù„Ù… Ø§Ù„Ù‚Ø±Ø¢Ù†</span></title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Tajawal:wght@300;400;500;700&family=Amiri:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/quran.css">
    <link rel="icon" type="image/svg+xml" href="../assets/images/icon.svg">
    <link rel="apple-touch-icon" href="../assets/images/icon.png">
    <link rel="manifest" href="../manifest.json">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#064e3b" media="(prefers-color-scheme: dark)">
</head>

<body>
    <!-- Persistent Header -->
    <!-- Persistent Header with Mode Buttons -->
    <header class="quran-header">
        <div class="nav-buttons-row"
            style="display: flex; gap: 0.5rem; width: 100%; justify-content: space-between; align-items: center;">
            <button class="back-btn" onclick="window.location.href='../learn/learn.html'" title="Tillbaka / Ø±Ø¬ÙˆØ¹"
                aria-label="Tillbaka / Ø±Ø¬ÙˆØ¹">
                <svg viewBox="0 0 24 24" fill="none" class="icon-md" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>

            <button id="settingsBtn" class="settings-trigger" title="InstÃ¤llningar / Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"
                aria-label="InstÃ¤llningar / Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" onclick="openSettings()">
                âš™ï¸
            </button>
        </div>

        <div class="mode-selection-bar" id="modeSelectionBar">
            <span class="mode-indicator" id="modeIndicator"></span>
            <button class="mode-btn active" onclick="switchMode('browse')" id="btn-browse" title="BlÃ¤ddra / ØªØµÙØ­">
                <span class="mode-icon">ğŸ“œ</span>
            </button>
            <button class="mode-btn" onclick="switchMode('flashcard')" id="btn-flashcard" title="Flashcards / Ø¨Ø·Ø§Ù‚Ø§Øª">
                <span class="mode-icon">ğŸ—‚ï¸</span>
            </button>
            <button class="mode-btn" onclick="switchMode('quiz-fill')" id="btn-quiz-fill"
                title="Fyll i luckan / Ø£ÙƒÙ…Ù„ Ø§Ù„ÙØ±Ø§Øº">
                <span class="mode-icon">âœï¸</span>
            </button>
            <button class="mode-btn" onclick="switchMode('quiz')" id="btn-quiz" title="Quiz / Ø§Ø®ØªØ¨Ø§Ø±">
                <span class="mode-icon">â“</span>
            </button>
        </div>
    </header>

    <main>
        <!-- Browse View -->
        <div id="browseView" class="view-section active">
            <!-- Screen Title (In-View) -->
            <div class="quran-view-header" style="text-align: center; margin-bottom: 1.5rem; margin-top: 1rem;">
                <h1
                    style="font-family: 'Amiri', serif; font-size: 2.5rem; color: var(--quran-gold); margin: 0; text-shadow: 0 0 15px rgba(251, 191, 36, 0.4);">
                    ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†
                </h1>
                <div style="font-size: 1.2rem; color: #cbd5e1; margin-top: 0.2rem;">Koranord</div>
            </div>

            <div class="search-container">
                <input type="text" id="searchInput" class="glass-input" data-i18n-placeholder="quran.searchPlaceholder"
                    placeholder="SÃ¶k ord, surah...">
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar" id="filterBar">
                <select class="glass-select" id="surahFilter" data-i18n-title="quran.filterSurah">
                    <option value="all" data-i18n="quran.allSurahs">Alla Suror</option>
                    <option value="favorites">â¤ï¸ <span class="sv-text">Favoriter</span><span
                            class="ar-text">Ø§Ù„Ù…ÙØ¶Ù„Ø©</span>
                    </option>
                    <!-- Populated via JS -->
                </select>
                <select class="glass-select" id="typeFilter" data-i18n-title="quran.filterType">
                    <option value="all" data-i18n="quran.allTypes">Alla Typer</option>
                    <option value="verb" data-i18n="quran.verb">Verb</option>
                    <option value="noun" data-i18n="quran.noun">Substantiv</option>
                    <option value="particle" data-i18n="quran.particle">Partikel</option>
                    <option value="phrase" data-i18n="quran.phrase">Fras</option>
                    <option value="word" data-i18n="quran.word">Ord</option>
                </select>
            </div>

            <!-- Daily Goal Widget (Hidden in Quran screen) -->
            <div class="daily-goal-widget hidden" id="dailyGoalWidget">
                <span>ğŸ“… <span class="sv-text">Dagens MÃ¥l:</span><span class="ar-text">Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…:</span></span>
                <div class="goal-track">
                    <div class="goal-fill" id="dailyGoalFill"></div>
                </div>
                <span id="dailyGoalText">0/5</span>
            </div>

            <!-- List Mode -->
            <div class="quran-list" id="quranList">
                <!-- Cards will be injected here via JS -->
            </div>
        </div>

        <!-- Flashcard View -->
        <div id="flashcardView" class="view-section hidden">


            <div class="fc-wrapper">
                <!-- Flashcard Settings -->
                <div class="quiz-settings">
                    <label class="toggle-switch">
                        <input type="checkbox" id="fcLangToggle" aria-label="Byt sprÃ¥k fÃ¶r flashcards">
                        <span class="slider round"></span>
                    </label>
                    <span id="fcModeLabel">
                        <span class="sv-text">ğŸ‡¸ğŸ‡¦ Arabiska (Framsida)</span>
                        <span class="ar-text">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø§Ù„Ø£Ù…Ø§Ù…)</span>
                    </span>
                </div>

                <!-- Flashcard Container -->
                <div class="quran-flashcard" id="quranFlashcard">
                    <div class="fc-inner">
                        <div class="fc-front">
                            <div class="fc-top-bar">
                                <span class="badger surah-badge" id="fcSurah">Surah</span>
                                <div class="action-group">
                                    <button class="share-btn" id="fcShareBtn" title="Dela / Ù…Ø´Ø§Ø±ÙƒØ©">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="18" cy="5" r="3"></circle>
                                            <circle cx="6" cy="12" r="3"></circle>
                                            <circle cx="18" cy="19" r="3"></circle>
                                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                                        </svg>
                                    </button>
                                    <button class="fav-btn" id="fcFavBtn" title="Spara / Ø­ÙØ¸">
                                        <svg viewBox="0 0 24 24" width="24" height="24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path
                                                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="fc-word-large" id="fcWord">Word</div>
                            <div class="fc-hint">
                                <span class="sv-text">Klicka fÃ¶r att vÃ¤nda</span>
                                <span class="ar-text">Ø§Ø¶ØºØ· Ù„Ù„Ù‚Ù„Ø¨</span>
                            </div>
                        </div>
                        <div class="fc-back">
                            <div class="fc-top-bar">
                                <span class="badger opacity-0">.</span> <!-- Spacer -->
                                <div class="action-group">
                                    <button class="share-btn" id="fcShareBtnBack" title="Dela / Ù…Ø´Ø§Ø±ÙƒØ©">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="18" cy="5" r="3"></circle>
                                            <circle cx="6" cy="12" r="3"></circle>
                                            <circle cx="18" cy="19" r="3"></circle>
                                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                                        </svg>
                                    </button>
                                    <button class="fav-btn" id="fcFavBtnBack" title="Spara / Ø­ÙØ¸">
                                        <svg viewBox="0 0 24 24" width="24" height="24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path
                                                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="fc-meaning" id="fcMeaning">Meaning</div>
                            <div class="fc-ayah-context" id="fcAyah">Ayah Context</div>
                            <div class="fc-ayah-trans" id="fcTrans">Translation</div>
                        </div>
                    </div>
                </div>

                <!-- Rating Controls -->
                <div class="fc-controls rating-controls" id="ratingControls">
                    <button class="rate-btn wrong" data-rating="again">
                        <span>âŒ</span>
                        <small class="sv-text">Igen</small>
                        <small class="ar-text">Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</small>
                    </button>
                    <button class="rate-btn hard" data-rating="hard">
                        <span>ğŸ¤”</span>
                        <small class="sv-text">SvÃ¥r</small>
                        <small class="ar-text">ØµØ¹Ø¨</small>
                    </button>
                    <button class="rate-btn good" data-rating="good">
                        <span>âœ…</span>
                        <small class="sv-text">Bra</small>
                        <small class="ar-text">Ø¬ÙŠØ¯</small>
                    </button>
                    <button class="rate-btn easy" data-rating="easy">
                        <span>ğŸš€</span>
                        <small class="sv-text">LÃ¤tt</small>
                        <small class="ar-text">Ø³Ù‡Ù„</small>
                    </button>
                </div>

                <!-- Navigation Controls -->
                <div class="fc-controls nav-only mt-10px opacity-70">
                    <button class="control-btn" id="prevCardBtn">â®</button>
                    <div class="fc-progress" id="fcProgress">1 / 100</div>
                    <button class="control-btn" id="nextCardBtn">â¯</button>
                </div>
            </div>
        </div>

        <!-- Quiz View -->
        <div id="quizView" class="view-section hidden">


            <div class="quiz-wrapper">
                <div class="quiz-stats">
                    <span>
                        <span class="sv-text">PoÃ¤ng:</span><span class="ar-text">Ø§Ù„Ù†Ù‚Ø§Ø·:</span> <span
                            id="quizScore">0</span> |
                        <span class="sv-text">Streak:</span><span class="ar-text">Ø³Ù„Ø³Ù„Ø©:</span> <span
                            id="quizStreak">0</span>ğŸ”¥
                    </span>
                    <div class="xp-container">
                        <div class="xp-donut" id="xpDonut">
                            <div class="xp-donut-inner">
                                <span id="userXP">0</span>
                                <small>XP</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quiz Settings -->
                <div class="quiz-settings">
                    <label class="toggle-switch">
                        <input type="checkbox" id="quizLangToggle" checked aria-label="Byt sprÃ¥k fÃ¶r quiz">
                        <span class="slider round"></span>
                    </label>
                    <span id="quizModeLabel">
                        <span class="sv-text">ğŸ‡¸ğŸ‡¦ Arabiska â” ğŸ‡¸ğŸ‡ª Svenska</span>
                        <span class="ar-text">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© â” ğŸ‡¸ğŸ‡ª Ø§Ù„Ø³ÙˆÙŠØ¯ÙŠØ©</span>
                    </span>
                </div>

                <div class="quiz-card">
                    <div class="quiz-question-type">
                        <span class="sv-text">Vad betyder detta ord?</span>
                        <span class="ar-text">Ù…Ø§Ø°Ø§ ØªØ¹Ù†ÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙƒÙ„Ù…Ø©ØŸ</span>
                    </div>
                    <div class="quiz-target-word" id="quizWord">WORD</div>

                    <div class="quiz-options" id="quizOptions">
                        <!-- Options injected via JS -->
                    </div>

                    <div class="quiz-feedback hidden" id="quizFeedback"></div>
                </div>

                <button class="next-question-btn hidden" id="nextQuestionBtn">
                    <span class="sv-text">NÃ¤sta FrÃ¥ga</span>
                    <span class="ar-text">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</span> â¯
                </button>
            </div>
        </div>
    </main>

    <!-- Generic Modal for Tafsir/Info -->
    <div id="infoModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" onclick="closeInfoModal()">&times;</span>
            <h2 id="modalTitle">
                <span class="sv-text">Tafsir & Info</span>
                <span class="ar-text">ØªÙØ³ÙŠØ± ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª</span>
            </h2>
            <div id="modalBody">
                <p>Loading...</p>
            </div>
        </div>
    </div>
    <!-- Fill-in-Blank Quiz View -->
    <div id="quizFillView" class="view-section hidden">
        <div class="quiz-fill-container">
            <div class="quiz-fill-header">
                <div class="quiz-fill-progress">
                    <span class="sv-text">FrÃ¥ga</span><span class="ar-text">Ø³Ø¤Ø§Ù„</span>
                    <span id="fillCurrentQ">1</span> / <span id="fillTotalQ">10</span>
                </div>
                <div class="quiz-fill-score">
                    <span class="sv-text">PoÃ¤ng:</span><span class="ar-text">Ø§Ù„Ù†Ù‚Ø§Ø·:</span>
                    <span id="fillScore">0</span>
                </div>
            </div>

            <div class="quiz-fill-question" id="fillQuestionCard">
                <div class="fill-ayah-context" id="fillAyahContext">
                    <div class="fill-ayah-arabic" id="fillAyahArabic">...</div>
                    <div class="fill-ayah-translation" id="fillAyahTranslation">...</div>
                </div>



                <div class="fill-word-highlight" id="fillTargetWord">...</div>
            </div>

            <div class="quiz-fill-options" id="fillOptions">
                <!-- Options will be generated dynamically -->
            </div>

            <div class="quiz-fill-feedback" id="fillFeedback" style="display: none;">
                <div class="feedback-content"></div>
                <button class="fill-next-btn" id="fillNextBtn">
                    <span class="sv-text">NÃ¤sta</span>
                    <span class="ar-text">Ø§Ù„ØªØ§Ù„ÙŠ</span> â†’
                </button>
            </div>

            <div class="quiz-fill-results" id="fillResults" style="display: none;">
                <h2>
                    <span class="sv-text">Quiz SlutfÃ¶rd!</span>
                    <span class="ar-text">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</span>
                </h2>
                <div class="results-score">
                    <div class="score-circle">
                        <span id="fillFinalScore">0</span>/<span id="fillFinalTotal">10</span>
                    </div>
                    <div class="score-percentage" id="fillPercentage">0%</div>
                </div>
                <div class="results-actions">
                    <button class="result-btn primary" onclick="switchMode('quiz-fill')">
                        <span class="sv-text">FÃ¶rsÃ¶k igen</span>
                        <span class="ar-text">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</span>
                    </button>
                    <button class="result-btn secondary" onclick="switchMode('browse')">
                        <span class="sv-text">Tillbaka</span>
                        <span class="ar-text">Ø±Ø¬ÙˆØ¹</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content settings-content">
            <div class="modal-header">
                <h2>
                    âš™ï¸ <span class="sv-text">InstÃ¤llningar</span><span class="ar-text">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                </h2>
                <span class="close-modal" id="closeSettingsBtn">&times;</span>
            </div>

            <div class="setting-item">
                <label for="themeSelector">
                    ğŸ¨ <span class="sv-text">FÃ¤rgtema</span><span class="ar-text">Ù„ÙˆÙ† Ø§Ù„Ø«ÙŠÙ…</span>
                </label>
                <select id="themeSelector" class="glass-select full-width"
                    data-i18n-title="settings.themeSelectorTitle">
                    <option value="default">ğŸŸ¢ Emerald</option>
                    <option value="sage">ğŸŒ¿ Sage</option>
                    <option value="luxury">ğŸ‘‘ Luxury</option>
                    <option value="teal">ğŸ’  Teal</option>
                    <option value="ruby">ğŸ’ Ruby</option>
                    <option value="bronze">ğŸº Bronze</option>
                    <option value="midnight">ğŸŒ™ Midnight</option>
                    <option value="sunset">ğŸŒ… Sunset</option>
                    <option value="amethyst">ğŸ”µ Electric</option>
                    <option value="oasis">ğŸŒ´ Oasis</option>
                    <option value="sky">â˜ï¸ Sky</option>
                    <option value="ocean">ğŸŒŠ Ocean</option>
                    <option value="navy">âš“ Navy</option>
                    <option value="obsidian">âš« Obsidian</option>
                    <option value="slate">ğŸ—¿ Slate</option>
                </select>
            </div>

            <div class="setting-item">
                <label for="mobileViewToggle">
                    ğŸ“± <span class="sv-text">Mobilvy</span><span class="ar-text">Ø¹Ø±Ø¶ Ø§Ù„Ø¬ÙˆØ§Ù„</span>
                </label>
                <label class="toggle-switch">
                    <input type="checkbox" id="mobileViewToggle" aria-label="Aktivera Mobilvy">
                    <span class="slider round"></span>
                </label>
            </div>

            <div class="setting-item">
                <label for="globalFcLangToggle">
                    ğŸ‡¸ğŸ‡¦ <span class="sv-text">Visa Arabiska i Flashcards</span><span class="ar-text">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                        ÙÙŠ
                        Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</span>
                </label>
                <label class="toggle-switch">
                    <input type="checkbox" id="globalFcLangToggle" checked aria-label="Visa Arabiska i Flashcards">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>
    </div>
    <!-- Scripts -->
    <script type="module" src="../src/learn/quran.ts"></script>
</body>

</html>